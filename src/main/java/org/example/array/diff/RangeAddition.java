package org.example.array.diff;

import org.example.util.ArrayUtil;

/**
 * 370. åŒºé—´åŠ æ³• ğŸ”’
 * é¢˜ç›®æè¿°
 * å‡è®¾ä½ æœ‰ä¸€ä¸ªé•¿åº¦ä¸º n çš„æ•°ç»„ï¼Œåˆå§‹æƒ…å†µä¸‹æ‰€æœ‰çš„æ•°å­—å‡ä¸º 0ï¼Œä½ å°†ä¼šè¢«ç»™å‡º k ä¸ªæ›´æ–°çš„æ“ä½œã€‚
 * å…¶ä¸­ï¼Œæ¯ä¸ªæ“ä½œä¼šè¢«è¡¨ç¤ºä¸ºä¸€ä¸ªä¸‰å…ƒç»„ï¼š[startIndex, endIndex, inc]ï¼Œ
 * ä½ éœ€è¦å°†å­æ•°ç»„ A[startIndex ... endIndex]ï¼ˆåŒ…æ‹¬ startIndex å’Œ endIndexï¼‰å¢åŠ  incã€‚
 * è¯·ä½ è¿”å› k æ¬¡æ“ä½œåçš„æ•°ç»„ã€‚
 * ç¤ºä¾‹:
 * è¾“å…¥: length = 5, updates = [[1,3,2],[2,4,3],[0,2,-2]]
 * è¾“å‡º: [-2,0,3,5,3]
 * è§£é‡Š:
 * åˆå§‹çŠ¶æ€:
 * [0,0,0,0,0]
 * è¿›è¡Œäº†æ“ä½œ [1,3,2] åçš„çŠ¶æ€:
 * [0,2,2,2,0]
 * è¿›è¡Œäº†æ“ä½œ [2,4,3] åçš„çŠ¶æ€:
 * [0,2,5,5,3]
 * è¿›è¡Œäº†æ“ä½œ [0,2,-2] åçš„çŠ¶æ€:
 * [-2,0,3,5,3]
 * Created on 2024/11/11 23:01
 */
public class RangeAddition {

    /**
     * å·®åˆ†æ•°ç»„ diff ä¿ç•™äº†åŸæ•°ç»„ result ç›¸é‚»å…ƒç´ çš„å·®å€¼ã€‚
     * å¦‚æœæˆ‘ä»¬æƒ³å°† result çš„ä¸€ä¸ªå­åŒºé—´ [startIndex, endIndex] å†…çš„æ‰€æœ‰å…ƒç´ å¢åŠ  incï¼Œ
     * æˆ‘ä»¬åªéœ€è¦è®© diff[startIndex] å¢åŠ  incï¼Œdiff[endIndex+1] å‡å» incï¼Œ
     * è¿™æ ·æ“ä½œå diff æ•°ç»„åœ¨ [startIndex, endIndex] åŒºé—´å†…çš„å‰ç¼€å’Œéƒ½ä¼šå¢åŠ  incã€‚
     * è¿™æ˜¯å› ä¸º diff æ•°ç»„ä¸åŸæ•°ç»„ result ä¹‹é—´çš„å…³ç³»æ˜¯è¿™æ ·çš„ï¼š
     * result[0] = diff[0]
     * result[1] = diff[0] + diff[1]
     * result[2] = diff[0] + diff[1] + diff[2]
     * ...
     * result[i] = diff[0] + diff[1] + ... + diff[i]
     * æ‰€ä»¥ï¼Œå¦‚æœæˆ‘ä»¬åœ¨ diff æ•°ç»„çš„ startIndex å¢åŠ  incï¼Œ
     * é‚£ä¹ˆæ ¹æ®ä¸Šé¢çš„å…³ç³»ï¼Œä» result[startIndex] åˆ° result[n-1] çš„æ‰€æœ‰å…ƒç´ éƒ½ä¼šå¢åŠ  incã€‚
     * ä¸ºäº†æŠµæ¶ˆ endIndex ä¹‹åçš„å¢åŠ ï¼Œæˆ‘ä»¬åœ¨ diff[endIndex+1] å‡å» incã€‚
     * è¿™æ ·ï¼Œä» result[endIndex+1] åˆ° result[n-1] çš„å…ƒç´ å°±ä¸ä¼šå—åˆ°å½±å“ã€‚
     * æœ€åï¼Œé€šè¿‡å¯¹ diff æ•°ç»„è®¡ç®—å‰ç¼€å’Œï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°è°ƒæ•´åçš„ result æ•°ç»„ã€‚
     * è¿™ä¸ªå·®åˆ†æ•°ç»„æŠ€å·§çš„ä¼˜ç‚¹åœ¨äºæ›´æ–°æ“ä½œçš„æ•ˆç‡éå¸¸é«˜ï¼Œæ— è®ºåŒºé—´å¤šå¤§ï¼Œæ›´æ–°æ“ä½œçš„å¤æ‚åº¦å§‹ç»ˆæ˜¯ O(1)ã€‚
     * è€Œæœ€ç»ˆè®¡ç®—å‰ç¼€å’Œçš„æ“ä½œå¤æ‚åº¦æ˜¯ O(n)ï¼Œå› æ­¤æ€»çš„å¤æ‚åº¦æ˜¯ O(n + k)ï¼Œè¿™åœ¨æœ‰å¤§é‡æ›´æ–°æ“ä½œæ—¶æ˜¯éå¸¸é«˜æ•ˆçš„ã€‚
     */
    public static int[] getModifiedArray(int length, int[][] updates) {
        // åˆå§‹åŒ–å·®åˆ†æ•°ç»„ï¼Œåˆå§‹å€¼ä¸º 0
        int[] diff = new int[length];
        // åº”ç”¨æ‰€æœ‰æ›´æ–°æ“ä½œ
        for (int[] update : updates) {
            // æ›´æ–°æ“ä½œçš„èµ·å§‹ç´¢å¼•
            int startIndex = update[0];
            // æ›´æ–°æ“ä½œçš„ç»“æŸç´¢å¼•
            int endIndex = update[1];
            // æ›´æ–°æ“ä½œçš„å¢é‡å€¼
            int inc = update[2];
            // å°†å¢é‡åº”ç”¨åˆ°å·®åˆ†æ•°ç»„çš„èµ·å§‹ä½ç½®
            diff[startIndex] += inc;
            // å¦‚æœç»“æŸç´¢å¼•çš„ä¸‹ä¸€ä¸ªä½ç½®åœ¨æ•°ç»„èŒƒå›´å†…ï¼Œå°†å…¶å‡å»å¢é‡
            if (endIndex + 1 < length) {
                diff[endIndex + 1] -= inc;
            }
        }
        // æ ¹æ®å·®åˆ†æ•°ç»„è®¡ç®—ç»“æœæ•°ç»„
        int[] result = new int[length];
        // ç¬¬ä¸€ä¸ªå…ƒç´ çš„å€¼ç”±å·®åˆ†æ•°ç»„çš„ç¬¬ä¸€ä¸ªå€¼å†³å®š
        result[0] = diff[0];
        for (int i = 1; i < length; i++) {
            // è®¡ç®—æ¯ä¸ªä½ç½®çš„å€¼ä½œä¸ºå‰ä¸€ä¸ªä½ç½®çš„å€¼åŠ ä¸Šå·®åˆ†æ•°ç»„å¯¹åº”ä½ç½®çš„å€¼
            result[i] = result[i - 1] + diff[i];
        }
        return result;
    }

    public static void main(String[] args) {
        int length = 5;
        int[][] updates = {{1, 3, 2}, {2, 4, 3}, {0, 2, -2}};
        int[] modifiedArray = getModifiedArray(length, updates);
        // è¾“å‡ºåº”ä¸º: -2 0 3 5 3
        ArrayUtil.print(modifiedArray);
    }
}
